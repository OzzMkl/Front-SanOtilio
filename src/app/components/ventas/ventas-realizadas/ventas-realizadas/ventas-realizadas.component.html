<p-toast></p-toast>
<app-loading-spinner [isLoading]="isLoadingGeneral"></app-loading-spinner>
<div class="container-fluid">
    <h3 class="text-center">Ver ventas</h3>
    <div>
        <p-dropdown
                [options]="optionsSelect"
                [(ngModel)]="selectedOpt"
                [showClear]="true"
                placeholder="Selecciona una opcion"
                [style]="{ width: '15%' }"
                optionLabel="name"
                (ngModelChange)="onSearch()"
        ></p-dropdown>
        <p-dropdown
                [options]="optionsSelect2"
                [(ngModel)]="selectedOpt2"
                [showClear]="true"
                placeholder="Selecciona una opcion"
                [style]="{ width: '15%' }"
                optionLabel="name"
                (ngModelChange)="onSearch()"
        ></p-dropdown>
        <input type="text" pInputText [(ngModel)]="valSearch" [style]="{ width: '70%' }" (ngModelChange)="onSearch()">
    </div>
    <br>
    <p-table
        [value]="ventas"
        styleClass="p-datatable-sm"
        [scrollable]="true"
        scrollHeight="380px"
        selectionMode="single"
        [(selection)]="selectedVenta"
        dataKey="idVenta"
        (onRowSelect)="onRowSelect($event)"
        >
        <ng-template pTemplate="header">
            <tr>
                <th>FOLIO</th>
                <th>FECHA</th>
                <th>CLIENTE</th>
                <th>VENDEDOR</th>
                <th>TIPO VENTA</th>
                <th>TOTAL</th>
                <th>CREDITO</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-venta let-rowIndex="rowIndex">
            <tr [pSelectableRow]="venta" (dblclick)="openMdlVenta(venta)">
                <td>{{venta.idVenta}}</td>
                <td>{{venta.created_at | date: 'dd/MM/yyyy'}}</td>
                <td>{{venta.nombreCliente.length > 40 ? (venta.nombreCliente | slice:0:25) + '...' : venta.nombreCliente }}</td>
                <td>{{venta.nombreEmpleado.length > 40 ? (venta.nombreEmpleado | slice:0:25) + '...' : venta.nombreEmpleado}}</td>
                <td>{{venta.nombreTipoventa}}</td>
                <td>{{venta.total | currency:'MXN'}}</td>
                <td>{{venta.isCredito | booleanToYesNo}}</td>
            </tr>
        </ng-template>
    </p-table>
</div>

<app-modal-ventas></app-modal-ventas>